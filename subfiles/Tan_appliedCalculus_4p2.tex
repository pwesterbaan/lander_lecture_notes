\documentclass[../mathNotesPreamble]{subfiles}

\providecommand{\relscalefact}{1.4}
\begin{document}
\relscale{\relscalefact}
  \section{4.2: Applications of the Second Derivative}
    \begin{defn*}
    Consider any differentiable function $f(x)$ on the interval $(a,b)$. We say $f$ is
    \begin{center}
      \begin{tikzpicture}[declare function={
        a=1; b=2; c=3.4; d=1; ell=0.25; t=0.725; eps=0.05;
        con_up(\x)=1.1^x;
        con_dn(\x)=ln(x+1.1)/ln(1.1);
        }]
        \begin{groupplot}[
          group style={group size=2 by 1, horizontal sep=20mm, vertical sep=0cm},
          axis lines=center,
          axis line style={black,->},
          xmajorticks=false,
          ymajorticks=false,
          enlargelimits={value=0.05, auto},
          ticklabel style={font=\normalsize,inner sep=0.5pt,fill=white,opacity=1.0, text opacity=1},
          every axis plot/.append style={domain=xmin:xmax,line width=0.95pt, color=lander_blue, samples=255},
          ]
          \nextgroupplot[title=concave up if $f'(x)$ is increasing]
            \addplot[-] expression[domain=0:20]{con_up(x)};
          \nextgroupplot[title=concave down if $f'(x)$ is decreasing]
            \addplot[-] expression[domain=0:20]{con_dn(x)};
        \end{groupplot}
      \end{tikzpicture}
    \end{center}
    Thus, for every value of $x$ on the interval $(a,b)$, if
    \begin{enumerate}[--]
      \item $f''(x)>0$, then $f'$ is increasing, and $f$ is concave \emph{up} on $(a,b)$.
      \item $f''(x)<0$, then $f'$ is decreasing, and $f$ is concave \emph{down} on $(a,b)$.
      \item If $f$ is continuous at $c$ and $f$ changes concavity at $c$, then $f$ has an \textbf{inflection point} at $c$.
    \end{enumerate}

    \emph{Note}: $f(x)$ is
    \TabPositions{120mm}
    \begin{enumerate}[--]
      \item concave up if its tangent lines lie below the curve \tab
        \begin{tikzpicture}[declare function={
          a=0.5; eps=0.5;
          xmin=a-eps; xmax=a+eps;
          f(\x)=\x^2;
          fp(\x)=2*\x;}]
          \begin{axis}[axis lines=none, width=27.5mm, height=25mm]
            \addplot[<->, lander_blue] expression[domain=-1:1]{f(x)};
            \addplot[-, red, line width=0.75pt] expression[domain=xmin:xmax]{fp(a)*(x-a)+f(a)};
          \end{axis}
        \end{tikzpicture}
      \item concave down if its tangent lines lie above the curve \tab
        \begin{tikzpicture}[declare function={
          a=0.5; eps=0.5;
          xmin=a-eps; xmax=a+eps;
          f(\x)=-\x^2;
          fp(\x)=-2*\x;}]
          \begin{axis}[axis lines=none, width=27.5mm, height=25mm]
            \addplot[<->, lander_blue] expression[domain=-1:1]{f(x)};
            \addplot[-, red, line width=0.75pt] expression[domain=xmin:xmax]{fp(a)*(x-a)+f(a)};
          \end{axis}
        \end{tikzpicture}
    \end{enumerate}
  \end{defn*}
  \pagebreak

  \begin{thmBox*}[Determining the Intervals of Concavity of the Graph of $f$]
    \begin{enumerate}
      \item Determine the values of $x$ for which $f''$ is zero or undefined.
      \item Determine the sign of $f''(x)$ to the left and right of each point from above:\\
        Let $c$ be a convenient test point on the interval of interest. Then,
        \TabPositions{120mm}
        \begin{enumerate}
          \item if $f''(c)>0$, then $f$ is concave up on that interval. \tab
            \tikz{\begin{axis}[axis lines=none, width=27.5mm, height=20mm]
              \addplot[<->, lander_blue] expression[domain=-1:1]{x^2};
            \end{axis}}
          \item if $f''(c)<0$, then $f$ is concave down on that interval. \tab
            \tikz{\begin{axis}[axis lines=none, width=27.5mm, height=20mm]
              \addplot[<->, lander_blue] expression[domain=-1:1]{-x^2};
            \end{axis}}
        \end{enumerate}
    \end{enumerate}
  \end{thmBox*}

  \begin{ex*}
    Find the intervals where the following functions are concave up and concave down:
  \end{ex*}
  \begin{extasks}[after-item-skip=\stretch{1}](1)
    \task $f(x)=x^3-3x^2-24x+32$ \hfill \href[pdfnewwindow]{https://www.desmos.com/calculator/re1imdb5c4}{\textcolor{blue}{\underline{Graph}}}
    \task $g(x)=(x+1)^{2/3}$
  \end{extasks}
  \vspace*{\stretch{1}}
  \pagebreak

  \begin{extasks}[after-item-skip=\stretch{1}](1)
    \task $h(x)=x+\dfrac{1}{x}$
    \task $j(x)=\dfrac{x^2}{1-x^2}$
  \end{extasks}
  \vspace*{\stretch{1}}
  \pagebreak

  \begin{thmBox*}[Finding inflection points]
    \begin{enumerate}
      \item Compute $f''(x)$.
      \item Locate where $f''(x)=0$ or $f''(x)$ does not exist.
      \item Determine if the sign of $f''(x)$ changes at the points found above.
    \end{enumerate}
  \end{thmBox*}

  \begin{center}
    \begin{tikzpicture}[declare function={
      c=3;
      f_eps=2.5;  g_eps=3;
      h_eps=2.75; j_eps=2;
      cubeRoot(\x)=\x/abs(\x)*abs(\x)^(1/3);
      f(\x)=(\x-c)^3;
      g(\x)=(\x-c)^4;
      h(\x)=cubeRoot(\x-c)+3;
      j(\x)=cubeRoot(\x-c)^2+3;},
      custNode/.style={
        black,
        align=center,
        inner sep=2.5pt,
        rounded corners,
        fill=white,
        opacity=0.8,
        text opacity=1.0},
      custPin/.style={
        custNode,
        pin edge={black!50}}]
      \begin{groupplot}[
        group style={group size=2 by 2, horizontal sep=30mm, vertical sep=20mm},
        axis x line=bottom,
        axis y line=left,
        axis line style={black,->},
        xtick={c},
        xticklabel={$c$},
        ymajorticks=false,
        enlargelimits={value=0.275, auto},
        every axis plot/.append style={domain=0:6, line width=0.95pt, color=lander_blue, samples=255},
        clip=false
        ]
        \nextgroupplot[title={Inflection point at $x=c$}]
          \addplot[-] {f(x)};
          \addplot[soldot] coordinates{(c,{f(c)})}
           node[pin={[custPin] 105:$f''(c)=0$}] {};
          \node[below right, custNode, yshift=-5pt] at (axis cs: c-f_eps,{f(c-f_eps)}) {Concave\\ down};
          \node[above left, custNode, yshift=5pt] at (axis cs: c+f_eps,{f(c+f_eps)}) {Concave\\ up};
        \nextgroupplot[title={\emph{No} inflection point at $x=c$}]
          \addplot[-] {g(x)};
          \addplot[soldot] coordinates{(c,{g(c)})}
           node[pin={[custPin] $f''(c)=0$}] {};
          \node[above, custNode] at (axis cs: c-g_eps,{g(c-g_eps)}) {Concave\\ up};
          \node[above, custNode] at (axis cs: c+g_eps,{g(c+g_eps)}) {Concave\\ up};
        \nextgroupplot[title={Inflection point at $x=c$}]
          \addplot[-] {h(x)};
          \addplot[soldot] coordinates{(c,{h(c)})}
           node[pin={[custPin] 135:{$f''(c)$ does\\ not exist}}] {};
          \node[above, custNode, yshift=9pt] at (axis cs: c-h_eps,{h(c-h_eps)}) {Concave\\ up};
          \node[below, custNode, yshift=-9pt] at (axis cs: c+h_eps,{h(c+h_eps)}) {Concave\\ down};
        \nextgroupplot[title={\emph{No} inflection point at $x=c$}]
          \addplot[-] {j(x)};
          \addplot[soldot] coordinates{(c,{j(c)})}
           node[pin={[custPin] 180:{$f''(c)$ does\\ not exist}}] {};
          \node[below left, custNode] at (axis cs: c-j_eps,{j(c-j_eps)}) {Concave\\ down};
          \node[below right, custNode] at (axis cs: c+j_eps,{j(c+j_eps)}) {Concave\\ down};
      \end{groupplot}
    \end{tikzpicture}
  \end{center}
  \pagebreak

  \begin{ex*}
    For the following functions, determine the intervals of concavity and find any inflection points.
  \end{ex*}
  \begin{extasks}[after-item-skip=\stretch{1}](1)
    \task $f(x)=\parens{x-1}^{5/3}$ \hfill \href[pdfnewwindow]{https://www.desmos.com/calculator/1jpmsat84m}{\textcolor{blue}{\underline{Graph}}}

    \task $g(x)=\dfrac{1}{x^2+1}$
  \end{extasks}
  \vspace*{\stretch{1}}
  \pagebreak

  \begin{thmBox*}[Second Derivative Test for Local Extrema]
    Suppose $f''$ is continuous on an open interval containing $c$ with $f'(c)=0$.
    \begin{itemize}
      \item If $f''(c)>0$, then $f$ has a local minimum at $c$.
      \item If $f''(c)<0$, then $f$ has a local maximum at $c$.
      \item If $f''(c)=0$, then the test is inconclusive; $f$ may have a local maximum, local minimum, or neither at $c$.
    \end{itemize}
  \end{thmBox*}
  \begin{ex*}
    Find the relative extrema of
      \[f(x)=x^3-3x^2-24x+32\]
      \hfill \href[pdfnewwindow]{https://www.desmos.com/calculator/re1imdb5c4}{\textcolor{blue}{\underline{Graph}}}
  \end{ex*}
  \pagebreak

  \begin{center}
    \begin{tikzpicture}[declare function={
      c=4.875; x_eps=0.6; y_eps=2;
      a=2; co=4.9375; ct=5.99594; ctr=7.25834; cf=8.44573; cfv=10.5; b=11.5;
      fo(\x)=2.25*sin(deg(\x+pi/2-c));
      ft(\x)=5;
      fr(\x)=(\x-5)^2*(\x-7)*(\x-7.5)*(8.875-\x)+ft(\x);
      fv(\x)=-(\x-cfv)^3;
      %Piecewise function using f1(x)-f1(c)+f2(c), etc to ensure continuity
      g(\x)=\x<c  ? fo(\x)-fo(c)+ft(c):
           (\x<5  ? ft(\x):
           (\x<cf ? fr(\x):
                    fv(\x)-fv(cf)+fr(cf)));
      mp(\x,\y)=(\x+\y)/2;
      ga=g(a)+y_eps;     gco=g(co)+y_eps; gct=g(ct)+y_eps;
      gctr=g(ctr)+y_eps; gcf=g(cf)+y_eps; gcfv=g(cfv)+y_eps;
      gb=g(b)+y_eps;
      dHeight=0.75*ga;
      },
      custNode/.style={
        black,
        align=center,
        font=\large,
        inner sep=2.5pt,
        rounded corners,
        fill=white,
        opacity=0.8,
        text opacity=1.0},
      custPin/.style={
        custNode,
        pin edge={black!50}}]
      \begin{axis}[
        unbounded coords=jump,
        grid style={line width=0.35pt, draw=gray!75},
        axis x line=center,
        axis y line=none,
        ymin=0,
        axis line style={black,-},
        xtick={a,co,ct,ctr,cf,cfv,b},
        xticklabels={$\vphantom{b}a$, $\vphantom{b}c_1$, $\vphantom{b}c_2$, $\vphantom{b}c_3$, $\vphantom{b}c_4$, $\vphantom{b}c_5$, $b$},
        ymajorticks=false,
        enlargelimits={abs=0.75},
        width=\linewidth, height=1.25*\axisdefaultheight,
        ticklabel style={fill=white,opacity=1.0, text opacity=1},
        every axis plot/.append style={inner sep=0.5pt, line width=0.95pt, color=lander_blue},
        clip=false
        ]
          \addplot[-] expression[domain=a:b, samples=1023]{g(x)+y_eps};
          \draw[dashed] (a,0) -- (a,ga)      (co,0) -- (co,gco)
                        (ct,0) -- (ct,gct)   (ctr,0) -- (ctr,gctr)
                        (cf,0) -- (cf,gcf)   (cfv,0) -- (cfv,gcfv)
                        (b,0) -- (b,gb);
          \addplot[soldot, red] coordinates{(a,ga)(b,gb)};
          \addplot[-, red] expression[domain=co-x_eps:co+x_eps]{gco};
          \addplot[-, red] expression[domain=ct-x_eps:ct+x_eps]{gct};
          \addplot[-, red] expression[domain=ctr-x_eps:ctr+x_eps]{gctr};
          \addplot[-, red] expression[domain=cfv-x_eps:cfv+x_eps]{gcfv};

          \node[custNode, above left] at (a,ga) {Abolute\\min};
          \node[custNode, above, pin={[custPin] 120:{No extremum\\$f'=0$}}] at (co,gco) {};
          \node[custNode, above, yshift=5pt] at (ct,gct) {Local max\\$f'=0$};
          \node[custNode, below, yshift=-5pt] at (ctr,gctr) {Local min\\$f'=0$};
          \node[custNode, above, yshift=5pt] at (cf,gcf) {Local max\\Absolute max\\$f'$ undefined};
          \node[custNode, above, xshift=7.5pt, yshift=7.5pt] at (cfv,gcfv) {No extremum\\$f'=0$};

          \node[custNode] at ({mp(a,co)},   dHeight) {$f'>0$};
          \node[custNode] at ({mp(co,ct)},  dHeight) {$f'>0$};
          \node[custNode] at ({mp(ct,ctr)}, dHeight) {$f'<0$};
          \node[custNode] at ({mp(ctr,cf)}, dHeight) {$f'>0$};
          \node[custNode] at ({mp(cf,cfv)}, dHeight) {$f'<0$};
          \node[custNode] at ({mp(cfv,b)},  dHeight) {$f'<0$};
        \end{axis}
      \end{tikzpicture}
    \end{center}

  \vspace*{\stretch{1}}
  \begin{center}
    \begin{tabularx}{0.95\linewidth}{*{3}{X}}\toprule
      $f(x)$& $f'(x)$& $f''(x)$\\\midrule
      increasing& positive& ---\\
      decreasing& negative& ---\\
      max/min& crit. pt. \& changes sign& ---\\
      concave up& increasing& positive\\
      concave down& decreasing& negative\\
      Inflection point& max/min& crit. pt. \& changes sign\\\bottomrule
    \end{tabularx}
  \end{center}
  \pagebreak
\end{document}
